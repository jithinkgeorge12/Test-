import React, { useState } from 'react';
import { AgGridReact } from 'ag-grid-react';
import 'ag-grid-community/styles/ag-grid.css';
import 'ag-grid-community/styles/ag-theme-alpine.css';
import { AllModules } from '@ag-grid-enterprise/all-modules'; // Ensure you import all AG Grid Enterprise modules
import '@ag-grid-enterprise/all-modules/dist/styles/ag-grid.css';
import '@ag-grid-enterprise/all-modules/dist/styles/ag-theme-alpine.css';

const MyGridComponent = () => {
  const [rowData, setRowData] = useState([
    { dates: '2024-06-28T00:00:00', location: 'New York' },
    { dates: '2024-06-29T00:00:00', location: 'Los Angeles' },
  ]);

  const columnDefs = [
    {
      headerName: 'Dates',
      field: 'dates',
      sortable: true,
      filter: true,
      editable: true,
      cellEditor: 'agDateInput', // Use AG Grid Enterprise date picker editor
      cellEditorParams: {
        displayFormat: 'dd-mm-yyyy', // Set display format for the date picker
        browserDatePicker: true, // Enable browser's native date picker if available
      },
    },
    { headerName: 'Location', field: 'location', sortable: true, filter: true, editable: true },
  ];

  const handleCellValueChanged = (event) => {
    const { data, colDef, newValue } = event;
    const updatedRowData = [...rowData];
    const rowIndex = updatedRowData.findIndex((row) => row === data);
    if (rowIndex > -1) {
      const updatedRow = { ...updatedRowData[rowIndex] };
      updatedRow[colDef.field] = newValue;
      updatedRowData[rowIndex] = updatedRow;
      setRowData(updatedRowData);
    }
  };

  const handleAddRow = () => {
    const newRow = { dates: '', location: '' };
    setRowData([...rowData, newRow]);
  };

  return (
    <div className="ag-theme-alpine" style={{ height: '400px', width: '100%' }}>
      <AgGridReact
        columnDefs={columnDefs}
        rowData={rowData}
        onCellValueChanged={handleCellValueChanged}
        modules={AllModules} // Ensure you pass all AG Grid Enterprise modules
      />
      <button onClick={handleAddRow}>Add Row</button>
    </div>
  );
};

export default MyGridComponent;

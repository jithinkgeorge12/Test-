WITH json_data AS (
  SELECT 
    id,
    name,
    clob_column,
    JSON_QUERY(clob_column, '$.data') AS data_json
  FROM your_table
),
fund_keys AS (
  SELECT 
    id,
    name,
    key
  FROM json_data,
    JSON_TABLE(
      data_json,
      '$'
      COLUMNS (
        key VARCHAR2(4000) PATH 'lax $.*'
      )
    )
  WHERE key LIKE 'funddetails%'
),
fund_details AS (
  SELECT 
    fk.id,
    fk.name,
    fk.key AS fund_key,
    JSON_QUERY(jd.data_json, '$.' || fk.key || '.collection.properties') AS properties_json
  FROM fund_keys fk
  JOIN json_data jd ON fk.id = jd.id
)
SELECT 
  fd.id,
  fd.name,
  fd.fund_key,
  JSON_VALUE(fd.properties_json, '$.field1' RETURNING VARCHAR2(4000)) AS field1,
  JSON_VALUE(fd.properties_json, '$.field2' RETURNING VARCHAR2(4000)) AS field2
FROM fund_details fd;
